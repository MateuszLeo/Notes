"use strict";

Object.defineProperty(exports, "__esModule", {
    value: true
});
function rejectWithMessage(error) {
    return Promise.reject(error.message);
}

exports["default"] = function (key, replacer, reviver) {
    return {
        load: function load() {
            return new Promise(function (resolve) {
                var jsonState = localStorage.getItem(key);
                resolve(JSON.parse(jsonState, reviver) || {});
            })["catch"](rejectWithMessage);
        },
        save: function save(state) {
            return new Promise(function (resolve) {
                var jsonState = JSON.stringify(state, replacer);
                localStorage.setItem(key, jsonState);
                resolve();
            })["catch"](rejectWithMessage);
        }
    };
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9pbmRleC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7OztBQUFBLFNBQVMsaUJBQVQsQ0FBMkIsS0FBM0IsRUFBa0M7QUFDOUIsV0FBTyxRQUFRLE1BQVIsQ0FBZSxNQUFNLE9BQXJCLENBQVA7QUFDSDs7cUJBRWMsVUFBQyxHQUFELEVBQU0sUUFBTixFQUFnQixPQUFoQjtBQUFBLFdBQTZCO0FBQ3hDLFlBRHdDLGtCQUNqQztBQUNILG1CQUFPLElBQUksT0FBSixDQUFZLFVBQUMsT0FBRCxFQUFhO0FBQzVCLG9CQUFNLFlBQVksYUFBYSxPQUFiLENBQXFCLEdBQXJCLENBQWxCO0FBQ0Esd0JBQVEsS0FBSyxLQUFMLENBQVcsU0FBWCxFQUFzQixPQUF0QixLQUFrQyxFQUExQztBQUNILGFBSE0sV0FHRSxpQkFIRixDQUFQO0FBSUgsU0FOdUM7QUFReEMsWUFSd0MsZ0JBUW5DLEtBUm1DLEVBUTVCO0FBQ1IsbUJBQU8sSUFBSSxPQUFKLENBQVksVUFBQyxPQUFELEVBQWE7QUFDNUIsb0JBQU0sWUFBWSxLQUFLLFNBQUwsQ0FBZSxLQUFmLEVBQXNCLFFBQXRCLENBQWxCO0FBQ0EsNkJBQWEsT0FBYixDQUFxQixHQUFyQixFQUEwQixTQUExQjtBQUNBO0FBQ0gsYUFKTSxXQUlFLGlCQUpGLENBQVA7QUFLSDtBQWR1QyxLQUE3QjtBQUFBLEMiLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VzQ29udGVudCI6WyJmdW5jdGlvbiByZWplY3RXaXRoTWVzc2FnZShlcnJvcikge1xuICAgIHJldHVybiBQcm9taXNlLnJlamVjdChlcnJvci5tZXNzYWdlKTtcbn1cblxuZXhwb3J0IGRlZmF1bHQgKGtleSwgcmVwbGFjZXIsIHJldml2ZXIpID0+ICh7XG4gICAgbG9hZCgpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBqc29uU3RhdGUgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShrZXkpO1xuICAgICAgICAgICAgcmVzb2x2ZShKU09OLnBhcnNlKGpzb25TdGF0ZSwgcmV2aXZlcikgfHwge30pO1xuICAgICAgICB9KS5jYXRjaChyZWplY3RXaXRoTWVzc2FnZSk7XG4gICAgfSxcblxuICAgIHNhdmUoc3RhdGUpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBqc29uU3RhdGUgPSBKU09OLnN0cmluZ2lmeShzdGF0ZSwgcmVwbGFjZXIpO1xuICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oa2V5LCBqc29uU3RhdGUpO1xuICAgICAgICAgICAgcmVzb2x2ZSgpO1xuICAgICAgICB9KS5jYXRjaChyZWplY3RXaXRoTWVzc2FnZSk7XG4gICAgfVxufSk7XG4iXX0=